
@section HEAD{
    <title>景點介紹</title>
    <link href="~/Content/attractions-introduction-2.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.9/components/rating.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.9/components/rating.js"></script>
}

<div class="header">
    <h1 class="title">景點介紹</h1>
</div>
<div class="choosing">
    <div class="category">
        <img src="~/Image/category-icon/人文.png">
        <a href="#人文">人文</a>
    </div>
    <div class="category">
        <img src="~/Image/category-icon/人造景觀.png">
        <a href="#人造景觀">人造景觀</a>
    </div>
    <div class="category">
        <img src="~/Image/category-icon/休閒.png">
        <a href="#休閒">休閒</a>
    </div>
    <div class="category">
        <img src="~/Image/category-icon/自然.png">
        <a href="#自然">自然</a>
    </div>
    <div class="category">
        <img src="~/Image/category-icon/宗教.png">
        <a href="#宗教">宗教</a>
    </div>
</div>

<div class="center">
    <div class="grid">
        <div id="attractions" class="row"></div>
    </div>
</div>

<div id="attraction-detail" hidden>
    <div class="overlay" onclick="closeDetail()"></div>

    <div class="overlay-dialogue">
        <img src="~/Image/popS.png" class="popIcon">
        <div class="placeName"></div>
        <div class="popIntro">
            <div class="popImage"></div>           
            <div class="popInfo" style="margin-top:-90px;">
                <div class="function">
                    <div class="rate">
                        <span style="font-size:14pt;color: rgba(115, 99, 120, 1);">評分：</span>
                        <div class="ui large star rating">
                            <i class="icon"></i>
                            <i class="icon"></i>
                            <i class="icon"></i>
                            <i class="icon"></i>
                            <i class="icon"></i>
                            <i class="icon"></i>
                            <i class="icon"></i>
                            <i class="icon"></i>
                            <i class="icon"></i>
                            <i class="icon"></i>
                        </div>
                    </div>
                </div>
                <h3>資訊</h3>
                <hr>
                <p>
                    <span>電話：</span>
                    <span class="phone"></span>
                    <br>
                    <span>地址：</span>
                    <span class="address"></span>
                    <br>
                    <span>分類：</span>
                    <span class="category"></span>
                </p>
            </div>
            <div class="popDetail">
                <h3>簡介</h3>
                <hr>
                <p class="detail"></p>                
            </div>
            <div class="close">
                <div style="width:30px;height:30px;margin:auto;">
                    <label onclick="closeDetail()" style="cursor:pointer">
                        <img src="~/Image/close.png" title="關閉" alt="關閉"/>
                    </label>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="footer">
</div>

<script>
    //拿取所有景點資料，用在<景點介紹>頁面
    var attrData
    $.ajax({
        url: '/Home/AttractionsInfo',
        type: 'GET',
        dataType: 'json',
        success: function (data) {
            attrData = data
            var display = []
            var category = ['人文', '人造景觀', '休閒', '自然', '宗教']
            
            for (var i = 0; i < category.length; ++i) {
                display[i] = []
                for (var j = 0; j < data.length; ++j) {
                    if (data[j][11] == category[i]) {
                        display[i].push(data[j])
                    }
                }
            }

            var first = true
            for (var i = 0; i < display.length; ++i) {
                for (var j = 0; j < display[i].length; ++j) {
                    var html
                    if (first) {
                        html = '<div id="' + category[i] + '" class="col-sm-4 attraction-intro" data-id="' + display[i][j][0] + '">'
                        first = false
                    }
                    else {
                        html = '<div class="col-sm-4 attraction-intro" data-id="' + display[i][j][0] + '">'
                    }
                    
                    html += '<div class="photo"><img src="/Image/pictures/' + display[i][j][0] + '.jpg" alt=""></div>'
                    html += '<div class="intro">'
                    html += '<img src="/Image/category-icon/' + display[i][j][11] + '.png">'
                    html += '<div class="detail">'
                    html += '<h2>' + display[i][j][1] + '</h2>'
                    html += '<hr/>'
                    html += '<p>高雄市 ' + display[i][j][2] + '</p>'
                    html += '</div>'
                    html += '<div class="button" onclick="popupDetail($(this))">了解更多</div>'
                    //html += '<label for="our-popup"><div class="button" onclick="lockScroll()"><b>了解更多</b></div></label>'
                    html += '</div></div>'
                    $('#attractions').append(html)
                }
                first = true
            }
        }
    })

    function findAttr(id) {
        for (var i = 0; i < attrData.length; ++i) {
            if(id == attrData[i][0])
                return attrData[i]
        }
        return null
    }

    function popupDetail(button) {
        attrId = button.parents('.attraction-intro').data('id')
        attr = findAttr(attrId)
        $detail = $('#attraction-detail')
        $detail.find('.placeName').html('<span>' + attr[1] + '</span>')
        $detail.find('.popImage').html('<img src="/Image/pictures/' + attrId + '.jpg"/>')
        $detail.find('.phone').html(attr[4])
        $detail.find('.address').html(attr[5])
        $detail.find('.detail').html('<span>　　</span>' + attr[3])
        $detail.find('.category').html(attr[11])
        $detail.show()

        $('.ui.rating').rating({
            initialRating: Math.round(parseFloat(attr[12]) / 0.2),
            maxRating: 10
        })
    }

    function closeDetail() {
        $('#attraction-detail').hide()
    }

    

    
    
</script>


